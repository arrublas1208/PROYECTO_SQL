# üì¶ Gesti√≥n de una Finca de Producci√≥n Agr√≠cola

## üìÑ Descripci√≥n del Proyecto
El proyecto **"Gesti√≥n Agroindustrial"** es un sistema de base de datos dise√±ado para administrar de manera integral las operaciones de una finca de producci√≥n agr√≠cola.  
Su objetivo principal es optimizar la gesti√≥n de clientes, ventas, producci√≥n, inventarios, compras, proveedores, maquinaria, mantenimiento y dem√°s procesos clave.  

La base de datos incluye:
- Registro y seguimiento de **clientes** y sus direcciones.
- Gesti√≥n de **productos**, precios y proveedores.
- Control de **ventas** y sus detalles.
- Administraci√≥n de **inventarios** por bodega.
- Registro de **compras** y relaci√≥n con proveedores.
- Control de **producci√≥n** y uso de maquinaria.
- Programaci√≥n y control de **mantenimientos**.
- Automatizaci√≥n de procesos mediante **procedimientos, funciones, triggers y eventos**.
- Roles de usuario con diferentes permisos seg√∫n sus funciones.

---

## üñ•Ô∏è Requisitos del Sistema
Para ejecutar este proyecto, se requiere:
- **Sistema Gestor de Base de Datos:** MySQL **8.0** o superior.
- **Cliente de Administraci√≥n:** MySQL Workbench (o compatible).
- **Sistema Operativo:** Windows, Linux o macOS.
- Permisos de administrador en MySQL para crear bases de datos, tablas, usuarios y roles.

---

## ‚öôÔ∏è Instalaci√≥n y Configuraci√≥n

### 1Ô∏è‚É£ Crear la estructura de la base de datos
Ejecutar el script **`DDL.sql`**:
```sql
SOURCE /ruta/a/DDL.sql;
```

### 2Ô∏è‚É£ Cargar los datos iniciales
Ejecutar el script **`DML.sql`**:
```sql
SOURCE /ruta/a/DML.sql;
```

### 3Ô∏è‚É£ Crear funciones, procedimientos, triggers y eventos
En el siguiente orden:
```sql
SOURCE /ruta/a/DQL_FUNCIONES.sql;
SOURCE /ruta/a/DQL_PROCEDIMIENTOS.sql;
SOURCE /ruta/a/DQL_TRIGGERS.sql;
SOURCE /ruta/a/DQL_EVENTOS.sql;
```

### 4Ô∏è‚É£ Consultas de ejemplo
```sql
SOURCE /ruta/a/DQL_SELECT.sql;
```

### 5Ô∏è‚É£ Crear roles y usuarios
Ejecutar:
```sql
-- Administrador
CREATE USER 'administrador'@'localhost' IDENTIFIED BY 'Campus2023';
GRANT ALL PRIVILEGES ON gestion_agroindustrial.* TO 'administrador'@'localhost';

-- Gerente
CREATE USER 'gerente'@'localhost' IDENTIFIED BY 'Campus2023';
GRANT SELECT, INSERT, UPDATE, DELETE ON gestion_agroindustrial.ventas TO 'gerente'@'localhost';
GRANT SELECT, INSERT, UPDATE, DELETE ON gestion_agroindustrial.produccion TO 'gerente'@'localhost';
GRANT SELECT, INSERT, UPDATE, DELETE ON gestion_agroindustrial.inventario TO 'gerente'@'localhost';

-- Vendedor
CREATE USER 'vendedor'@'localhost' IDENTIFIED BY 'Campus2023';
GRANT SELECT, INSERT ON gestion_agroindustrial.ventas TO 'vendedor'@'localhost';
GRANT SELECT, INSERT ON gestion_agroindustrial.cliente TO 'vendedor'@'localhost';

-- Agricultor
CREATE USER 'agricultor'@'localhost' IDENTIFIED BY 'Campus2023';
GRANT SELECT, INSERT ON gestion_agroindustrial.produccion TO 'agricultor'@'localhost';

-- Contador
CREATE USER 'contador'@'localhost' IDENTIFIED BY 'Campus2023';
GRANT SELECT ON gestion_agroindustrial.ventas TO 'contador'@'localhost';
GRANT SELECT ON gestion_agroindustrial.compras TO 'contador'@'localhost';

FLUSH PRIVILEGES;
```

---

## üóÑÔ∏è Estructura de la Base de Datos
La base de datos **`gestion_agroindustrial`** contiene las siguientes tablas principales:

| Tabla | Descripci√≥n |
|-------|-------------|
| **CLIENTE** | Datos personales y tipo de cliente. |
| **DIRECCION_CLIENTE** | Direcciones asociadas a cada cliente. |
| **VENTAS** | Registro de ventas realizadas. |
| **DETALLES_VENTA** | Detalle de productos vendidos por venta. |
| **PRODUCTO** | Informaci√≥n de productos con tipo, precio y proveedor. |
| **PRECIO_PRODUCTO** | Hist√≥rico de precios por producto. |
| **PROVEEDOR** | Informaci√≥n de proveedores. |
| **INVENTARIO** | Control de stock por bodega. |
| **BODEGA** | Ubicaci√≥n y datos de bodegas. |
| **COMPRAS** / **DETALLES_COMPRA** | Registro y detalle de compras. |
| **PRODUCCION** | Producci√≥n agr√≠cola, responsable y maquinaria usada. |
| **MAQUINARIA** | Inventario y estado de maquinaria. |
| **MANTENIMIENTO** | Mantenimientos programados o realizados. |
| **DEPARTAMENTO** | Departamentos internos. |
| **EMPLEADO** | Informaci√≥n de empleados, cargo y salario. |

---

## üîç Ejemplos de Consultas
Algunas consultas incluidas en `DQL_SELECT.sql`:

```sql
-- Listar todos los clientes con sus datos
SELECT * FROM CLIENTE;

-- Productos con precio mayor a $2000
SELECT * FROM PRODUCTO WHERE Precio_unitario > 2000;

-- Ventas realizadas en enero de 2023
SELECT * FROM VENTAS 
WHERE Fecha_Venta BETWEEN '2023-01-01' AND '2023-01-31';

-- Clientes de tipo Mayorista
SELECT * FROM CLIENTE WHERE Tipo = 'Mayorista';

-- Total de ventas por m√©todo de pago
SELECT Metodo_Pago, SUM(Cantidad * Precio_Por_Unidad) AS Total
FROM DETALLES_VENTA dv
JOIN VENTAS v ON dv.ID_Venta = v.ID_Venta
GROUP BY Metodo_Pago;
```

---

## üõ†Ô∏è Procedimientos, Funciones, Triggers y Eventos

### **Procedimientos**
Ejemplos:
- `Agregar_clientes` ‚Üí Registra un nuevo cliente.
- `Modificar_precio` ‚Üí Actualiza precio de producto manteniendo hist√≥rico.
- `Reporte_Ventas` ‚Üí Genera informe de ventas por rango de fechas.
- `Rotacion_Inventario` ‚Üí Calcula la rotaci√≥n de inventarios.

### **Funciones**
Ejemplos:
- `Salario_Anual` ‚Üí Calcula salario anual de un empleado.
- `Precio_Producto` ‚Üí Obtiene precio por nombre de producto.
- `PrecioConIVA` ‚Üí Calcula precio con IVA del 19%.
- `DiasDesdeRegistro` ‚Üí D√≠as desde la primera compra de un cliente.

### **Triggers**
Ejemplos:
- Evitar eliminar proveedor con compras (`trg_proveedor_con_compras`).
- Descontar inventario tras una venta (`tr_after_venta_insert`).
- Bloquear eliminaci√≥n de bodega con inventario (`trg_bodega_con_inventario`).

### **Eventos**
Ejemplos:
- `Calcular_Costos_Produccion_Mensual` ‚Üí Calcula costos mensuales de producci√≥n.
- `Actualizar_Horas_Uso_Maquinaria` ‚Üí Suma horas diarias de uso.
- `Revisar_Caducidad_Precios` ‚Üí Detecta precios sin cambios en 180 d√≠as.

---

## üë• Roles de Usuario y Permisos
| Rol | Permisos |
|-----|----------|
| **Administrador** | Acceso total a todas las tablas y operaciones. |
| **Gerente** | CRUD en ventas, producci√≥n e inventario. |
| **Vendedor** | Lectura y alta de ventas y clientes. |
| **Agricultor** | Lectura y alta de producci√≥n. |
| **Contador** | Lectura de ventas y compras. |

---

## ü§ù Contribuciones
Este proyecto fue desarrollado por:
- **Carlos Cisneros Vega** ‚Äì Dise√±o y creaci√≥n de estructura de base de datos, procedimientos, triggers y funciones.
- **Juan Jose Arrublas Gutierrez** ‚Äì Inserci√≥n de datos, consultas avanzadas, creaci√≥n de eventos y documentaci√≥n.

---

## üìú Licencia y Contacto
**Licencia:** Libre uso para fines acad√©micos.  
**Contacto:** Para consultas o mejoras, escribir a: `contacto@gestionagro.com`.
